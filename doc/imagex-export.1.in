.TH IMAGEX "1" "May 2013" "@IMAGEX_PROGNAME@ @VERSION@" "User Commands"
.SH NAME
@IMAGEX_PROGNAME@-export \- Exports an image from a WIM archive to an existing or new WIM archive
.SH SYNOPSIS
\fB@IMAGEX_PROGNAME@ export\fR \fISRC_WIMFILE\fR \fISRC_IMAGE\fR
\fIDEST_WIMFILE\fR [\fIDEST_IMAGE_NAME\fR\] [\fIDEST_IMAGE_DESCRIPTION\fR]
[\fIOPTION\fR...]
.SH DESCRIPTION
Copies the specified image in \fISRC_WIMFILE\fR to \fIDEST_WIMFILE\fR,
optionally changing its name and/or description and/or compression type.
If \fIDEST_WIMFILE\fR exists, it is taken be be a WIM archive to which the image
will be appended.  Otherwise, it is created as a new WIM archive containing only
the exported image.
.PP
\fISRC_IMAGE\fR specifies the image in \fISRC_WIMFILE\fR to export.  It may be a
1-based index of an image in the WIM, the name of an image in the WIM, or the
keyword "all" to indicate that all images are to be exported.  Use the
\fB@IMAGEX_PROGNAME@ info\fR (1) command to list the images a WIM file contains.
.PP
If given, \fIDEST_IMAGE_NAME\fR specifies the name to give the image being
exported to \fIDEST_WIMFILE\fR.  The default is its name in \fISRC_WIMFILE\fR.
\fIDEST_IMAGE_NAME\fR cannot be specified if multiple images are being exported.
.PP
If given, \fIDEST_IMAGE_DESCRIPTION\fR specifies the description to give the
image being exported to \fIDEST_WIMFILE\fR.  The default is its description in
\fISRC_WIMFILE\fR.
.PP
\fB@IMAGEX_PROGNAME@ export\fR supports exporting images from stand-alone WIMs as well as
from split WIMs.  However, you cannot export an image to a split WIM.  See
\fBSPLIT WIMS\fR.
.PP
.SH OPTIONS
.TP 6
\fB--boot\fR
Specifies that the exported image is to be the bootable image of the destination
WIM archive.
.IP ""
If multiple images are being exported, this flag indicates that the image in the
\fISRC_WIMFILE\fR that is currently marked as bootable is to be made bootable in
\fIDEST_WIMFILE\fR.  If no image in \fISRC_WIMFILE\fR is bootable, it is an
error.
.TP
\fB--check\fR
When reading \fISRC_WIMFILE\fR, and \fIDEST_WIMFILE\fR if it exists, verify the
file's integrity if the integrity table is present; additionally, when writing
\fIDEST_WIMFILE\fR with the new image added, write an integrity table.  If this
option is not specified, no integrity table is included in \fIDEST_WIMFILE\fR,
even if there was one before.
.TP
\fB--compress\fR=\fITYPE\fR
Specifies the compression type for \fIDEST_WIMFILE\fR.  This is only valid if
\fIDEST_WIMFILE\fR does not yet exist, since if \fIDEST_WIMFILE\fR exists, the
compression type must be the same as that of \fIDEST_WIMFILE\fR.
.IP ""
\fITYPE\fR may be "none", "maximum", or "fast".  By default, it is the same as
that of the input WIM file.
.IP ""
You may also specify the actual names of the compression algorithms, "XPRESS"
and "LZX", instead of "fast" and "maximum", respectively.
.TP
\fB--threads\fR=\fINUM_THREADS\fR
Number of threads to use for compressing data.  Default: autodetect (number of
processors).  Note: if exporting to an uncompressed WIM, or exporting to a WIM
with the same compression type as the source WIM, additional threads will not
be used, regardless of this parameter, since no data compression needs to be
done in these cases.
.TP
\fB--rebuild\fR
When exporting image(s) to an existing WIM: rebuild the entire WIM rather than
appending data to the end of it.  Rebuilding the WIM is slower, but will save a
little bit of space that would otherwise be left as a hole in the WIM.  Also see
\fB@IMAGEX_PROGNAME@ optimize\fR.
.TP
\fB--ref\fR="\fIGLOB\fR"
File glob of additional split WIM parts that are part of the split WIM being
exported.  See \fBSPLIT_WIMS\fR.
.SH SPLIT WIMS
You may use \fB@IMAGEX_PROGNAME@ export\fR to export images from a split WIM.  The
\fISRC_WIMFILE\fR argument is used to specify the first part of the split WIM, and
the \fB--refs\fR="\fIGLOB\fR" option is used to provide a shell-style file glob
that specifies the additional parts of the split WIM.  \fIGLOB\fR is expected to
be a single string on the command line, so \fIGLOB\fR must be quoted so that it
is protected against shell expansion.  \fIGLOB\fR must expand to all parts of
the split WIM, except optionally the first part which may either omitted or
included in the glob (but the first part MUST be specified as \fISRC_WIMFILE\fR as
well).
.PP
Here's an example.  The names for the split WIMs usually go something like:
.PP
.RS
.nf
mywim.swm
mywim2.swm
mywim3.swm
mywim4.swm
mywim5.swm
.RE
.PP
To export the first image of this split WIM to a new or existing WIM file
"other.wim", run:
.PP
.RS
@IMAGEX_PROGNAME@ export mywim.swm 1 other.wim --ref="mywim*.swm"
.RE
.SH NOTES
It is safe to abort an \fB@IMAGEX_PROGNAME@ export\fR command partway through;
however, after doing this, it is recommended to run \fB@IMAGEX_PROGNAME@
optimize\fR on the destination WIM to remove any data that was appended to the
physical WIM file but not yet incorporated into the structure of the WIM, unless
\fB--rebuild\fR was specified, in which case you should delete the temporary
file left over.
.SH EXAMPLES
Export the second image of 'boot.wim' to the new WIM file 'new.wim', and
change the compression type to maximum, if it wasn't maximum already:
.RS
.PP
@IMAGEX_PROGNAME@ export boot.wim 2 new.wim --compress=maximum
.RE
.PP
.SH SEE ALSO
.BR @IMAGEX_PROGNAME@ (1)
.BR @IMAGEX_PROGNAME@-info (1)
.BR @IMAGEX_PROGNAME@-optimize (1)
