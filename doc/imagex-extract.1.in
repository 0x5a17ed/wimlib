.TH IMAGEX "1" "April 2013" "@IMAGEX_PROGNAME@ @VERSION@" "User Commands"
.SH NAME
@IMAGEX_PROGNAME@-extract \- Extract files or directories from a WIM image

.SH SYNOPSIS
\fB@IMAGEX_PROGNAME@ extract\fR \fIWIMFILE\fR \fIIMAGE\fR \fI[PATH\fR]... [\fIOPTION\fR]...

.SH DESCRIPTION
.PP

\fB@IMAGEX_PROGNAME@ extract\fR extracts one or more files or directory trees
from the specified \fIIMAGE\fR contained in the Windows Imaging (WIM) file
\fIWIMFILE\fR.

\fB@IMAGEX_PROGNAME@ extract\fR is intended for extracting only a subset of a
WIM image.  If you want to extract or "apply" a full WIM image to a directory or
NTFS volume, use \fB@IMAGEX_PROGNAME@ apply\fR (1) instead.

\fIIMAGE\fR specifies the image in \fIWIMFILE\fR that contains the files or
directory trees to extract.  It may be a 1-based index of an image in the WIM or
the name of an image in the WIM.  Use the \fB@IMAGEX_PROGNAME@ info\fR (1)
command to show what images a WIM file contains.

Each \fIPATH\fR specifies a file or directory tree within the WIM image to
extract.  See \fBPATH_SPECIFICATIONS\fR.

By default, files and directories are extracted to the current directory.  Use
\fB--dest-dir\fR to choose an alternate target directory.

\fB@IMAGEX_PROGNAME@ extract\fR supports extracting files and directory trees
from stand-alone WIMs as well as split WIMs.  See \fBSPLIT WIMS\fR.

.SH PATH SPECIFICATIONS

Each \fIPATH\fR specifies a file or directory tree within the WIM image to
extract.  Each path must be specified as an absolute path starting from the root
of the WIM image, like those output by the \fB@IMAGEX_PROGNAME@ dir\fR (1)
command.  Path separators may be forward slashes on UNIX, or either forward
slashes or backward slashes on Windows.  The leading slash is optional.

If no \fIPATH\fRs are provided, the default behavior is to extract the full
image, as if the path "/" had been provided.

.SH SPLIT WIMS

You may use \fB@IMAGEX_PROGNAME@ extract\fR to extract files or directory trees
from a split WIM.  This uses the \fB--refs\fR="\fIGLOB\fR" option in the same
way as in other commands such as \fB@IMAGEX_PROGNAME@ apply\fR.  See
\fB@IMAGEX_PROGNAME@ apply\fR (1) for more details.

.SH OPTIONS
.TP 6
\fB--check\fR
When reading \fIWIMFILE\fR, verify its integrity if the integrity table is
present.
.TP
\fB--verbose\fR
Print the path to of each file or directory within the WIM image as it is
extracted.
.TP
\fB--ref\fR="\fIGLOB\fR"
File glob of additional split WIM parts that are part of the split WIM.  See
\fBSPLIT_WIMS\fR.
.TP
\fB--unix-data\fR
Restore the UNIX-specific data captured using \fB@IMAGEX_PROGNAME@ capture\fR
with the \fB--unix-data\fR option.  This option is only available on UNIX.
.TP
\fB--no-acls\fR
Do not restore security descriptors on extracted files and directories.
.TP
\fB--strict-acls\fR
Fail immediately if the full security descriptor of any file or directory cannot
be set exactly as specified in the WIM file.  The default behavior without this
option is to fall back to setting a security descriptor with the SACL omitted,
then only the default inherited security descriptor, if we do not have
permission to set the desired one.
.TP
\fB--to-stdout\fR
Extract the files to standard output instead of to the filesystem.  This can
only be provided if all the specified \fIPATH\fRs are to regular files (not
directories or reparse points).  If present, alternate data streams are not
extracted.

.SH NOTES

\fB@IMAGEX_PROGNAME@ extract\fR calculates the SHA1 message digest of every file
stream it extracts and verifies that it is the same as the SHA1 message digest
provided in the WIM file.  Thus, it should provide assurance of data integrity.

Reparse-point fixups (a.k.a. changing absolute symbolic links and junctions to
point within the extraction location) are never done by \fB@IMAGEX_PROGNAME@
extract\fR.  Use \fB@IMAGEX_PROGNAME@ apply\fR if you want this behavior.

Unlike \fB@IMAGEX_PROGNAME@ apply\fR, \fB@IMAGEX_PROGNAME@ extract\fR does not
support extracting files directly to a NTFS volume using libntfs-3g.

Not all data and metadata contained in each WIM \fIPATH\fR will necessarily be
extracted, since \fB@IMAGEX_PROGNAME@ extract\fR does the best it can given the
platform (UNIX or Windows) and supported features of the filesystem.  The
documentation for \fB@IMAGEX_PROGNAME@ apply\fR (1) goes into more detail about
what data and metadata is extracted and what is not.

.SH EXAMPLES
Extract a file from the first image in "boot.wim" to the current directory:
.RS
.PP
@IMAGEX_PROGNAME@ extract boot.wim 1 /Windows/System32/notepad.exe
.RE
.PP
Extract a file from the first image in "boot.wim" to standard output:
.RS
.PP
@IMAGEX_PROGNAME@ extract boot.wim 1 /Windows/System32/notepad.exe --to-stdout
.RE
.PP
Extract a file from the first image in "boot.wim" to the specified directory:
.RS
.PP
@IMAGEX_PROGNAME@ extract boot.wim 1 /Windows/System32/notepad.exe --dest-dir=somedir
.RE
.PP
Extract the "sources" directory from the first image in "boot.wim" to the
current directory:
.RS
.PP
@IMAGEX_PROGNAME@ extract boot.wim 1 /sources
.RE
.PP
Extract multiple files and directories in one command:
.RS
.PP
@IMAGEX_PROGNAME@ extract boot.wim 1 /Windows/Fonts /sources /Windows/System32/cmd.exe
.RE
.PP

.SH SEE ALSO
.BR @IMAGEX_PROGNAME@ (1)
.BR @IMAGEX_PROGNAME@-apply (1)
.BR @IMAGEX_PROGNAME@-dir (1)
.BR @IMAGEX_PROGNAME@-info (1)
